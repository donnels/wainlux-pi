= ADR-001: Docker Containerization on Pi Zero W

== Status

Accepted (Consolidated from ADR-001, ADR-009)

== Context

Deploy Flask app to Pi Zero W (ARMv6). Handle Python dependencies (Pillow, pyserial, Flask).

*Deployment options:*
* Docker containerization
* Bare Python + pip
* Virtual environment + systemd
* .deb package

*Base image options:*
* Alpine Linux
* Official Raspberry Pi images
* Balena IoT images
* Debian slim
* Ubuntu

== Decision

Docker with `balenalib/raspberry-pi:bullseye` base.

== Rationale

=== Why Docker?

*Recipe-based:* Dockerfile = executable docs. No hidden steps.

*Migration:* Container runs anywhere. Move to new Pi = copy container. Move to x86 = rebuild from same Dockerfile.

*Isolation:* System deps (libjpeg, libxcb) in container. No system pollution. Clean uninstall = remove container.

*Reproducibility:* Same Dockerfile â†’ same environment. Every build identical.

*Version control:* Infrastructure as code. Changes tracked.

Rejected bare Python: Manual docs. Migration = rewrite.

Rejected .deb: Hardest to maintain. Cross-compilation. Overkill.

=== Why Balena Base?

*ARMv6 support:* Pi Zero W requirement. Alpine dropped ARMv6. Ubuntu doesn't support.

*Size:* 120MB vs 200MB+ official images.

*Tested:* Balena production-tested for IoT.

*Build time:* Pre-built layers save hours.

*Maintenance:* Active ARMv6 support.

== Consequences

.*Positive*
* Deployment = recipe, not procedure
* Migration trivial
* Dependencies isolated
* Build reproducible
* Stable ARMv6 platform
* Faster builds (120MB)

.*Negative*
* Docker adds complexity
* Slightly slower startup
* More disk space
* Balena-specific (less common)

*Trade-offs accepted:* Portability + reproducibility + ARMv6 support outweigh overhead.
